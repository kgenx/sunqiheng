#Virgil Sync

Virgil Sync encrypts user data using Virgil Crypto library, Virgil Public and Private keys infrastructure APIs and Dropbox Rest API.

Virgil Sync gets the list of files from application folder on Dropbox and synchronizes them with the files from mapped folder on the user’s machine. Files from the user’s selected folder are encrypted with the user’s public key and file names are hashed with SHA256. 

The general scheme:
![Virgil Sync Process](https://github.com/VirgilSecurity/virgil-sync/blob/master/Setup/virgil-sync-scheme.png "Virgil Sync Process")

1.	User creates Virgil account using Virgil CLI software.
2.	User choses local folder on his machine which will be used as a place where to store decrypted data.
3.	Virgil Sync starts to listen for the local file system changes.
4.	Every time local file system notifies Virgil sync process about any change, Virgil Sync software updates encrypted files in the user's Dropbox account using user's public key.
5.	Every time Dropbox file system changes (i.e. via Dropbox web interfaces or via another active machine of current user).
6.	Changed files are downloaded and decrypted using user's private key.


CLI version exposes 3 commands: 

```
  config    Configures Virgil Sync to use specific Virgil card and Dropbox account.
  start     Starts configured application
  reset     Removes stored Virgil Card, Private key and Dropbox authentication token from local store.
```

### Config

Configures Virgil sync software. It requires following options:

```
  -v, --virgil-card    Required. Path to the Virgil card file created from CLI.
  -k, --private-key    Required. Path to the private key of the specified Virgil card.
  -s, --source-dir     Required. Path to the directory you want to synchronize with Dropbox.
```

Config imports `virgil-card` and `private-key` files generated by Virgil CLI software, it also stores path to the `source-dir` to watch for local changes for. If all specified options are provided and valid, we open new browser window with the prompt to login to your Dropbox  account and grant Virgil Sync privileges to create Virgil Sync specific folder in your Dropbox account. 
Virgil Sync will have read and write access only to this folder.
Once you finish sign in you will be redirected to the https://www.virgilsecurity.com. Please copy whole address string and paste it into console prompt to let Virgil Sync authorize with Dropbox using OAuth token generated by Dropbox.
All sensitive data you’ve provided will be stored in the Keychain.

### Start

Once configured Virgil Sync is ready to be started. When started Virgil Sync will print the operations log into the console.

### Reset

Removes all Virgil Sync data stored in Keychain.
